#!/bin/sh

#
# If the hostname isn't given, take it from the name of the current tmux window.
#
: ${host:="`tmux list-panes -F '#{window_name}'`"}

if [ "$host" == "" ]; then
	echo "$$host not specified and not running in a tmux session"
	exit 1
fi


#
# Allow manual specification of the tmux path.
#
: ${tmux:="tmux"}


#
# Allow session name specification.
#
: ${session:="joe"}


#
# Actually, we don't *have* to use tmux at all...
#
: ${command:="$tmux attach -t $session || $tmux new-session -s $session"}

autossh -t -M 0 $host $* "$command"
